<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>u-connectXpress host library: ex_callbacks_edm_wifi</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ublox-logo.webp"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">u-connectXpress host library
   &#160;<span id="projectnumber">0.4</span>
   </div>
   <div id="projectbrief">AT and EDM parser for u-blox shortrange standalone modules</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ex_callbacks_edm_wifi-example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ex_callbacks_edm_wifi</div>  </div>
</div><!--header-->
<div class="contents">
<p>Using EDM, configure WiFi and transmit TCP data as a WiFi Station Using EDM, configure WiFi and transmit TCP data as a WiFi Station </p>
<h2><a class="anchor" id="autotoc_md30"></a>
Introduction</h2>
<p>This example is a complete example, which shows how to</p>
<p>Start the Serial Port Configure the module to autoconnect to a server Enter EDM Wait for connection to server Send and receive data over EDM</p>
<p>Once configured, the example is driven by events, which are handled by the callbacks <a class="el" href="ex__callbacks__edm__wifi_8c.html#a6e7724c82a506be32dbf496207a0f59c">onConnectIpV4()</a>, <a class="el" href="ex__callbacks__edm__wifi_8c.html#ab28ae1581a6be84ca672203be90ee23b" title="Prints the content of the data, asserting channel is -1.">onData()</a> and <a class="el" href="ex__callbacks__edm__wifi_8c.html#abce919d83064afe3e2e26899cc313567">onDisconnect()</a>.</p>
<p>A number of other callbacks, are registered as well, but these are only done to show how AT URCs and responses are reported as callbacks, and that some that require more intelligence, such as <a class="el" href="ex__callbacks__edm__wifi_8c.html#a426c3e76219dfcea592b8c3721011dd9">onNetworkStationUp()</a> which indicates that the station has received its IP adress, also are reported as callbacks.</p>
<p>Full source in <code><a class="el" href="ex__callbacks__edm__wifi_8c.html">examples/ex_callbacks_edm_wifi.c</a></code></p>
<h2><a class="anchor" id="autotoc_md31"></a>
Typical response</h2>
<pre class="fragment">Opening serial port...
Entering AT mode (in case NINA was in DATA mode)...
ex_callbacks_edm_wifi.c/onUnknownURC: '+STARTUP'
Handling stray responses
ex_callbacks_edm_wifi.c/onUnknownURC: 'AT'
Entering extended data mode (EDM)... ex_callbacks_edm_wifi.c/onUnknownURC: 'ATO2'
Handling stray responses again
Query NINA...
Configuring WiFi...
Activating WiFi...




Polling for up to 120s. Ensure a TCP server at 192.168.2.1 is listening on port 12345...



ex_callbacks_edm_wifi.c/onManufacturerIdentification:     Manufacturer:         'u-blox'
ex_callbacks_edm_wifi.c/onModelIdentification:            Model:                'NINA-W132'
ex_callbacks_edm_wifi.c/onIdentificationInformation:      Application Version:  '2.1.0-017'
                                                          Unique Identifier:    'NINA-W13X-2.1.0-017-0-g253211b6'
ex_callbacks_edm_wifi.c/onSoftwareVersionIdentification:  Software Version:     '2.1.0-017'
ex_callbacks_edm_wifi.c/onLocalAddress:                   Interface_id:         2 (WiFi STA)
                                                          MAC Address           'D4CA6EFD96E0'
ex_callbacks_edm_wifi.c/onWifiLinkConnected:              connection_id:        0
                                                          BSSID:                'D4CA6E889F82'
                                                          WiFi channel:         6
ex_callbacks_edm_wifi.c/onNetworkUp interface_id 0
ex_callbacks_edm_wifi.c/onNetworkStatus:
  interface_hardware_address: 'D4CA6EFD96E0'
  network_status: 1
  interface_id: 0
  interface_type: 1 (WIFI_STATION)
  ipv4_address: '192.168.2.101'
  ipv4_subnet_mask: '255.255.255.0'
  ipv4_gateway: '192.168.2.1'
  primary_dns_server: '192.168.2.1'
  secondary_dns_server: '0.0.0.0'
  ipv6_link_local_address: '::'
  ipv6_address[0]: 'FE80::D6CA:6EFF:FEFD:96E0', 1
  ipv6_address[1]: '::', 0
  ipv6_address[2]: '::', 0
ex_callbacks_edm_wifi.c/onNetworkStatus:
  interface_hardware_address: '000000000000'
  network_status: 0
  interface_id: 13
  interface_type: 5 (BRIDGE)
  ipv4_address: '0.0.0.0'
  ipv4_subnet_mask: '0.0.0.0'
  ipv4_gateway: '0.0.0.0'
  primary_dns_server: '0.0.0.0'
  secondary_dns_server: '0.0.0.0'
  ipv6_link_local_address: '::'
  ipv6_address[0]: '::', 0
  ipv6_address[1]: '::', 0
  ipv6_address[2]: '::', 0
ex_callbacks_edm_wifi.c/onNetworkStatus:
  interface_hardware_address: '000000000000'
  network_status: 0
  interface_id: 14
  interface_type: 5 (BRIDGE)
  ipv4_address: '0.0.0.0'
  ipv4_subnet_mask: '0.0.0.0'
  ipv4_gateway: '0.0.0.0'
  primary_dns_server: ''
  secondary_dns_server: ''
  ipv6_link_local_address: ''
  ipv6_address[0]: '', 0
  ipv6_address[1]: '', 0
  ipv6_address[2]: '', 0
ex_callbacks_edm_wifi.c/onNetworkUp interface_id 0
ex_callbacks_edm_wifi.c/onNetworkStationUp:
  interface_hardware_address: 'D4CA6EFD96E0'
  network_status: 1
  interface_id: 0
  interface_type: 1 (WIFI_STATION)
  ipv4_address: '192.168.2.101'
  ipv4_subnet_mask: '255.255.255.0'
  ipv4_gateway: '192.168.2.1'
  primary_dns_server: '192.168.2.1'
  secondary_dns_server: '0.0.0.0'
  ipv6_link_local_address: '::'
  ipv6_address[0]: 'FE80::D6CA:6EFF:FEFD:96E0', 1
  ipv6_address[1]: '::', 0
  ipv6_address[2]: '::', 0



Main loop detected WiFi Station interface configured and up.


Manually trying to connect to 192.168.2.1:12345
ex_callbacks_edm_wifi.c/onConnectIpV4: Channel 0: Connection event to localport 62809 from 192.168.2.1:12345, protocol TCP, lastChannel=-1



Main loop detected connection on channel 0: Transmitting 'Hello, World' from mainloop.

Send anything or 'quit' to us, shutdown server or wait for timeout


ex_callbacks_edm_wifi.c/onPeerConnected: peer_handle 0
  IPv4 local_port: 62809
  IPv4 remote_port: 12345
  IPv4 protocol: 0 (TCP)
  IPv4 local_address: '192.168.2.101'
  IPv4 remote_address: '192.168.2.1'
ex_callbacks_edm_wifi.c/onData: Channel 0: Data event of 7 bytes: 'Howdy!↵'
ex_callbacks_edm_wifi.c/onData: Channel 0: Data event of 5 bytes: 'quit↵'


Main loop detected 'quit'
Restarting module
Example completed
</pre><p>The server (netcat) would have shown</p>
<p>$ nc -lk 12345 Hello, World! Howdy! Server sent 'Howdy!' to me. quit</p>
<p>In s-center, it would have been displayed as</p>
<p>Hello, World! Server sent 'Howdy!' to me.</p>
<div class="fragment"></div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
